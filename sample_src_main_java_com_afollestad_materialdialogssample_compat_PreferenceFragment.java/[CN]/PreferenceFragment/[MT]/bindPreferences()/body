{
  final PreferenceScreen preferenceScreen=getPreferenceScreen();
  if (preferenceScreen != null) {
    preferenceScreen.bind(getListView());
  }
  if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.GINGERBREAD_MR1) {
    getListView().setOnItemClickListener(new AdapterView.OnItemClickListener(){
      @Override public void onItemClick(      AdapterView<?> parent,      View view,      int position,      long id){
        if (parent instanceof ListView) {
          position-=((ListView)parent).getHeaderViewsCount();
        }
        Object item=preferenceScreen.getRootAdapter().getItem(position);
        if (!(item instanceof Preference))         return;
        final Preference preference=(Preference)item;
        try {
          Method performClick=Preference.class.getDeclaredMethod("performClick",PreferenceScreen.class);
          performClick.setAccessible(true);
          performClick.invoke(preference,preferenceScreen);
        }
 catch (        InvocationTargetException e) {
        }
catch (        IllegalAccessException e) {
        }
catch (        NoSuchMethodException e) {
        }
      }
    }
);
  }
}
