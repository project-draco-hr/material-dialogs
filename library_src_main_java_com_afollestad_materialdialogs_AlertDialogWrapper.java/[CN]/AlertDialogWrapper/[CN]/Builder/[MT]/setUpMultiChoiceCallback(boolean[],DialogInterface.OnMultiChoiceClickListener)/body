{
  Integer selectedIndicesArr[]=null;
  if (checkedItems != null) {
    ArrayList<Integer> selectedIndices=new ArrayList<>();
    for (int i=0; i < checkedItems.length; i++) {
      if (checkedItems[i]) {
        selectedIndices.add(i);
      }
    }
    selectedIndicesArr=selectedIndices.toArray(new Integer[selectedIndices.size()]);
  }
  builder.alwaysCallMultiChoiceCallback();
  builder.itemsCallbackMultiChoice(selectedIndicesArr,new MaterialDialog.ListCallbackMulti(){
    @Override public void onSelection(    MaterialDialog dialog,    Integer[] which,    CharSequence[] text){
      List<Integer> whichList=Arrays.asList(which);
      if (checkedItems != null) {
        for (int i=0; i < checkedItems.length; i++) {
          boolean oldChecked=checkedItems[i];
          checkedItems[i]=whichList.contains(i);
          if (oldChecked != checkedItems[i]) {
            listener.onClick(dialog,i,checkedItems[i]);
          }
        }
      }
    }
  }
);
}
